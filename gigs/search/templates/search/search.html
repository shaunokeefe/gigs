{% extends "portal/portal_base.html" %}

{% block content %}
<div class="row-fluid">
    <h1>Gig List</h1>
    <br>
    {% include "search/search_form.html" %}  
</div>
<br>
<div class="row-fluid">
  {% if page.object_list %}
    {% load maps %}
    {% search_map page.object_list %}
    <br/>
    <form action="/gig_csv_subset/">
    <p>
    <input type=hidden name=ids value={% for g in page.object_list %}{% if not forloop.first %},{% endif %}{{g.object.pk}}{% endfor %}>
      <button class="btn btn-large btn-primary btn-block" type="post">Download results</button>
      </p>
      </form>
  <table class="table table-bordered">
    <thead>
        <tr><th>Gig Name</th/><th>Venue Name</th/><th>Headlining Band</th><th>Gig Start Time</th/></tr>
    </thead>
    <tbody>
    {% for gig_result in page.object_list %}
    {% with gig_result.object as gig %}
    {% include "portal/gig_row.html" %}
    {% endwith %}
    {% endfor %}
    </tbody>
    </table>
  {% else %}
    {% if query %}
    <div class="alert alert-error">
      <p>Your search didn't return any results.</p>
    </div>
    {% else %}
    <div class="alert alert-info">
      <p>Please enter a search term</p>
    </div>
    {% endif %}
  {%endif %}
</div>
{% endblock %}

